C
C .....................................................................
C LKMT3D PACKAGE IMPLEMENTED IN IUNIT (22)
C STR1 PACKAGE IMPLEMENTED IN IUNIT (14)
C MODIFY NEXT TWO STATEMENTS IF NECESSARY
C .....................................................................
      IMT3D=IUNIT(22)
      IUSTR=IUNIT(14)
C......................................................................
C
      IF(IMT3D.EQ.0) GOTO 9999
C
C--WRITE A NOTIFICATION LINE TO MODFLOW OUTPUT FILE
      WRITE(IOUT,9990) IMT3D
 9990 FORMAT(/1X,'HEADS AND FLOW TERMS SAVED ON UNIT',I3,
     & ' FOR USE BY MT3D TRANSPORT MODEL')

C--GATHER INFORMATION AND WRITE A HEADER TO THE
C--MODFLOW-MT3D LINK FILE AT THE 1ST TIME STEP
      IF(KKSTP*KKPER.EQ.1) THEN
        CALL GETHEADER(IUNIT,NPER,ISS,NODES,X(LCIBOU),IUSTR,IMT3D)
      ENDIF
C
C--COLLECT AND SAVE ALL RELEVANT FLOW MODEL INFORMATION
      CALL BAS1MT(X(LCHNEW),X(LCIBOU),X(LCBOT),X(LCTOP),
     &   NCOL,NROW,NLAY,KKSTP,KKPER,X(LCBUFF),IMT3D)
      IF(IUNIT(1).GT.0) CALL BCF2MT(X(LCHNEW),X(LCIBOU),X(LCCR),
     &   X(LCCC),X(LCCV),ISS,DELT,X(LCSC1),X(LCSC2),X(LCHOLD),
     &   X(LCTOP),NCOL,NROW,NLAY,KKSTP,KKPER,
     &   X(LCBUFF),IMT3D)
      IF(IUNIT(2).GT.0) CALL WEL1MT(NWELLS,MXWELL,
     &   X(LCWELL),X(LCIBOU),NCOL,NROW,NLAY,KKSTP,KKPER,IMT3D)
      IF(IUNIT(3).GT.0) CALL DRN1MT(NDRAIN,MXDRN,
     &   X(LCDRAI),X(LCHNEW),NCOL,NROW,NLAY,X(LCIBOU),KKSTP,
     &   KKPER,IMT3D)
      IF(IUNIT(8).GT.0) CALL RCH1MT(NRCHOP,X(LCIRCH),X(LCRECH),
     &   X(LCIBOU),NROW,NCOL,NLAY,KKSTP,KKPER,X(LCBUFF),IMT3D)
      IF(IUNIT(5).GT.0) CALL EVT1MT(NEVTOP,X(LCIEVT),X(LCEVTR),
     &   X(LCEXDP),X(LCSURF),X(LCIBOU),X(LCHNEW),NCOL,NROW,NLAY,
     &   KKSTP,KKPER,X(LCBUFF),IMT3D)
      IF(IUNIT(4).GT.0) CALL RIV1MT(NRIVER,MXRIVR,X(LCRIVR),X(LCIBOU),
     &   X(LCHNEW),NCOL,NROW,NLAY,KKSTP,KKPER,IMT3D)
      IF(IUNIT(4).EQ.0.AND.IUSTR.GT.0) CALL STR1MT(NSTREM,X(LCSTRM),
     &   X(ICSTRM),X(LCIBOU),MXSTRM,NCOL,NROW,NLAY,KKSTP,KKPER,IMT3D)
      IF(IUNIT(4).GT.0.AND.IUSTR.GT.0) THEN
         WRITE(IOUT,9997)
         STOP
      ENDIF
      IF(IUNIT(7).GT.0) CALL GHB1MT(NBOUND,MXBND,
     &   X(LCBNDS),X(LCHNEW),NCOL,NROW,NLAY,X(LCIBOU),KKSTP,
     &   KKPER,IMT3D)
 9997 FORMAT(/1X,'STOP.  RIV1 AND STR1 PACKAGES CANNOT BE USED',
     & ' CONCURRENTLY IN MT3D SIMULATION')
C
 9999 CONTINUE
C
C.......................................................................
C--END OF LKMT3.INC, last modified on 02-24-97
C.......................................................................
C
